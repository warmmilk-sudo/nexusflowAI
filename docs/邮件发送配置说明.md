# 邮件发送配置说明

## 概述

NexusFlow AI 现在支持真实的邮件发送功能。系统会根据配置情况自动选择最佳的发送方式。

## 配置步骤

### 1. 在设置页面配置邮箱

访问系统设置页面，填写以下信息：

- **邮箱地址**: 您的发件邮箱地址
- **邮箱密码**: 邮箱密码或应用专用密码
- **IMAP服务器**: 接收邮件服务器（如：imap.gmail.com）
- **SMTP服务器**: 发送邮件服务器（如：smtp.gmail.com）
- **发件人姓名**: 显示的发件人名称

### 2. Gmail 配置示例

如果使用 Gmail，建议使用应用专用密码：

```
邮箱地址: your-email@gmail.com
邮箱密码: [应用专用密码]
IMAP服务器: imap.gmail.com
SMTP服务器: smtp.gmail.com
发件人姓名: NexusFlow AI
```

### 3. 其他邮件服务商

- **Outlook/Hotmail**: 
  - IMAP: outlook.office365.com
  - SMTP: smtp-mail.outlook.com

- **QQ邮箱**:
  - IMAP: imap.qq.com
  - SMTP: smtp.qq.com

## 工作模式

### 真实发送模式
- 当邮件依赖包已安装且配置正确时
- 使用真实的SMTP服务器发送邮件
- 支持TLS加密连接

### 降级模式
- 当邮件配置错误或服务器不可达时
- 自动降级到模拟发送
- 在控制台显示邮件内容但不实际发送
- 返回成功状态以保证系统正常运行

## 安全说明

- 邮箱密码仅在内存中临时存储
- 不会保存到数据库或文件中
- 建议使用应用专用密码而非主密码
- 支持TLS加密传输

## 故障排除

### 常见错误

1. **530 Must issue a STARTTLS command first**
   - 解决方案: 系统已自动配置TLS支持

2. **535 Authentication failed**
   - 检查邮箱地址和密码是否正确
   - 确认是否需要使用应用专用密码

3. **连接超时**
   - 检查网络连接
   - 确认SMTP服务器地址正确

### 测试方法

1. 在设置页面配置邮箱后，系统会自动测试连接
2. 在批量外发页面发送测试邮件
3. 查看后端控制台日志了解详细状态

## 开发说明

- 系统在启动时会检查邮件依赖包
- 如果依赖不可用，会自动使用模拟模式
- 用户配置邮箱后，系统会尝试切换到真实发送模式
- 所有邮件发送都会有详细的日志记录